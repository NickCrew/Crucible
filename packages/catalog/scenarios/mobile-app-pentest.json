{
  "id": "mobile-app-pentest",
  "name": "Mobile Application Penetration Test",
  "category": "Mobile Security",
  "difficulty": "Expert",
  "description": "Advanced mobile application security testing with certificate pinning bypass and deep linking attacks",
  "steps": [
    {
      "id": "mobile-cert-1",
      "name": "Certificate Pinning Bypass Attempt",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/mobile/api/config",
        "headers": {
          "User-Agent": "MyApp/2.1.0 (Android 11; Mobile)",
          "X-Certificate-Pinning": "bypassed"
        }
      },
      "execution": {
        "delayMs": 2000
      },
      "expect": {
        "blocked": true
      }
    },
    {
      "id": "mobile-deep-1",
      "name": "Deep Link Parameter Injection",
      "stage": "delivery",
      "request": {
        "method": "GET",
        "url": "/mobile/deeplink",
        "headers": {
          "User-Agent": "MyApp/2.1.0 (iPhone; iOS 14.6; Scale/3.0)",
          "X-Deep-Link-Source": "external"
        },
        "params": {
          "action": "open",
          "url": "javascript:alert('XSS')",
          "data": "../../../etc/passwd"
        }
      },
      "execution": {
        "delayMs": 3000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "mobile-cert-1"
      ]
    },
    {
      "id": "mobile-root-1",
      "name": "Root Detection Bypass",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/mobile/api/auth",
        "headers": {
          "User-Agent": "MyApp/2.1.0 CFNetwork/1220.1 Darwin/20.3.0",
          "X-Device-Rooted": "false",
          "X-Debug-Mode": "disabled",
          "Content-Type": "application/json"
        },
        "body": {
          "device_id": "emulator_device_12345",
          "integrity_check": "bypassed_with_frida"
        }
      },
      "execution": {
        "delayMs": 4000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "mobile-deep-1"
      ]
    },
    {
      "id": "mobile-priv-1",
      "name": "Privilege Escalation via Intent",
      "stage": "exploitation",
      "request": {
        "method": "PUT",
        "url": "/mobile/api/preferences",
        "headers": {
          "User-Agent": "MyApp/2.1.0 (Android 11; Mobile)",
          "X-Intent-Action": "com.myapp.ADMIN_ACCESS",
          "Content-Type": "application/json"
        },
        "body": {
          "role": "admin",
          "permissions": [
            "read_all",
            "write_all",
            "delete_all"
          ]
        }
      },
      "execution": {
        "delayMs": 5000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "mobile-root-1"
      ]
    }
  ]
}
