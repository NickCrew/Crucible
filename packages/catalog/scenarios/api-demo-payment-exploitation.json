{
  "id": "api-demo-payment-exploitation",
  "name": "Payment Gateway & Merchant Fraud Campaign",
  "category": "Industry Attacks",
  "difficulty": "Advanced",
  "description": "Payment processing exploitation targeting gateways, merchant accounts, and currency manipulation similar to Magecart and payment card skimmers",
  "steps": [
    {
      "id": "payment-methods-enum",
      "name": "Payment Methods Enumeration",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/v1/payments/methods"
      },
      "execution": {
        "delayMs": 1000
      }
    },
    {
      "id": "test-cards-discovery",
      "name": "Test Card Numbers Discovery",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/payments/test-cards"
      },
      "execution": {
        "delayMs": 1500
      },
      "dependsOn": [
        "payment-methods-enum"
      ]
    },
    {
      "id": "bin-range-mapping",
      "name": "BIN Range Mapping",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/payments/bin-ranges",
        "headers": {
          "X-Include-Private": "true"
        }
      },
      "execution": {
        "delayMs": 2000
      },
      "dependsOn": [
        "test-cards-discovery"
      ]
    },
    {
      "id": "card-validation-bypass",
      "name": "Card Validation Bypass Test",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/cards/validate",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "card_number": "4111111111111111",
          "cvv": "123",
          "expiry": "12/99",
          "bypass_luhn": true
        }
      },
      "execution": {
        "delayMs": 500
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "bin-range-mapping"
      ]
    },
    {
      "id": "payment-authorize-fraud",
      "name": "Fraudulent Payment Authorization",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/v1/payments/authorize",
        "headers": {
          "Content-Type": "application/json",
          "X-Skip-3DS": "true"
        },
        "body": {
          "amount": 9999.99,
          "currency": "USD",
          "card_token": "stolen_token_abc123",
          "merchant_id": "COMPROMISED_MERCHANT"
        }
      },
      "execution": {
        "delayMs": 2000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "card-validation-bypass"
      ]
    },
    {
      "id": "amount-manipulation",
      "name": "Payment Amount Manipulation",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/payments/amount/manipulate",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "transaction_id": "TXN-123456",
          "original_amount": 100,
          "new_amount": 0.01
        }
      },
      "execution": {
        "delayMs": 1500
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "payment-authorize-fraud"
      ]
    },
    {
      "id": "currency-rate-manipulation",
      "name": "Currency Exchange Rate Manipulation",
      "stage": "exploitation",
      "request": {
        "method": "PUT",
        "url": "/api/currency/rates/manipulate",
        "headers": {
          "Content-Type": "application/json",
          "X-Admin-Key": "guessed_admin_key"
        },
        "body": {
          "from": "USD",
          "to": "EUR",
          "rate": 0.0001
        }
      },
      "execution": {
        "delayMs": 1000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "amount-manipulation"
      ]
    },
    {
      "id": "merchant-onboard-fake",
      "name": "Fake Merchant Onboarding",
      "stage": "persistence",
      "request": {
        "method": "POST",
        "url": "/api/v1/payments/merchant/onboard",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "business_name": "Totally Legitimate Business LLC",
          "mcc": "5999",
          "high_risk": false,
          "skip_kyc": true
        }
      },
      "execution": {
        "delayMs": 3000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "currency-rate-manipulation"
      ]
    },
    {
      "id": "bulk-payment-process",
      "name": "Bulk Payment Processing Attack",
      "stage": "impact",
      "request": {
        "method": "POST",
        "url": "/api/payments/bulk-process",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "payments": [
            {
              "amount": 99.99,
              "card": "4111111111111111"
            },
            {
              "amount": 99.99,
              "card": "5500000000000004"
            },
            {
              "amount": 99.99,
              "card": "340000000000009"
            },
            {
              "amount": 99.99,
              "card": "6011000000000004"
            },
            {
              "amount": 99.99,
              "card": "3528000000000007"
            }
          ],
          "parallel": true
        }
      },
      "execution": {
        "delayMs": 100
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "merchant-onboard-fake"
      ]
    },
    {
      "id": "merchant-limit-override",
      "name": "Merchant Processing Limit Override",
      "stage": "impact",
      "request": {
        "method": "PUT",
        "url": "/api/merchant/limits/override",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer compromised_merchant_token"
        },
        "body": {
          "merchant_id": "MERCHANT-001",
          "daily_limit": 99999999,
          "transaction_limit": 999999
        }
      },
      "execution": {
        "delayMs": 2000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "bulk-payment-process"
      ]
    },
    {
      "id": "settlement-manipulation",
      "name": "Settlement Data Manipulation",
      "stage": "impact",
      "request": {
        "method": "GET",
        "url": "/api/v1/payments/merchant/settlements?manipulate=true&double_settle=true",
        "headers": {
          "Authorization": "Bearer compromised_merchant_token"
        }
      },
      "execution": {
        "delayMs": 2500
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "merchant-limit-override"
      ]
    },
    {
      "id": "dispute-flood",
      "name": "Automated Dispute Flooding",
      "stage": "impact",
      "request": {
        "method": "GET",
        "url": "/api/v1/payments/merchant/disputes?create_fake=100",
        "headers": {
          "X-Automate": "true"
        }
      },
      "execution": {
        "delayMs": 1000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "settlement-manipulation"
      ]
    }
  ]
}
