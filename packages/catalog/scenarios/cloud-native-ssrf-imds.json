{
  "id": "cloud-native-ssrf-imds",
  "name": "IMDSv1/v2 SSRF Attack",
  "category": "Cloud Native",
  "difficulty": "Advanced",
  "description": "Performs SSRF to target the Instance Metadata Service (IMDS) and exfiltrate IAM role credentials.",
  "steps": [
    {
      "id": "imds-v1-probe",
      "name": "IMDSv1 SSRF Probe",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/v1/diagnostics/webhook?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/"
      },
      "execution": {
        "delayMs": 500
      },
      "expect": {
        "blocked": true
      }
    },
    {
      "id": "imds-v2-token",
      "name": "Fetch IMDSv2 Token (SSRF)",
      "stage": "exploitation",
      "request": {
        "method": "GET",
        "url": "/api/v1/diagnostics/webhook?url=http://169.254.169.254/latest/api/token",
        "headers": {
          "X-aws-ec2-metadata-token-ttl-seconds": "21600"
        }
      },
      "execution": {
        "delayMs": 1000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "imds-v1-probe"
      ]
    }
  ]
}
